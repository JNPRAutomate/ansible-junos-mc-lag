{# this generates MC-LAG Aggregation specific config. It will be merged with the config generated by the common role before it is applied to the device #}
{# ICL Interface configuration #}
interfaces {
    {{ mclag.icl_interface }} {
        description "{{ mclag.icl.description }}";
        unit 0 {
            family ethernet-switching {
                interface-mode trunk;
            }
        }
    }
{% for link in mclag.links.icl.links %}
    {{ link }} {
        ether-options {
            802.3ad {{ mclag.icl_interface }};
        }
    }
{% endfor %}
{# ICCP interface  #}
    {{ mclag.iccp_interface }} {
        unit 0 {
            family inet {
                address {{ mclag.iccp.local_ip }}/24
            }
        }
    }
{% for link in mclag.links.iccp.links %}
    {{ link }} {
        ether-options {
            802.3ad {{ mclag.iccp_interface }};
        }
    }
{% endfor %}
}

{# ICCP Protocol Configuration #}


switch-options {
    service-id 10;
}
{#}
multicast-snooping-options {
    multichassis-lag-replicate-state;
}
#}

multi-chassis {
    multi-chassis-protection {{ mclag.iccp.peer_ip }} {
        interface {{ mclag.icl_interface }};
    }
}
