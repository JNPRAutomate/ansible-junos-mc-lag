{# this generates MC-LAG Aggregation specific config. It will be merged with the config generated by the common role before it is applied to the device #}
{# ICL Interface configuration #}
interfaces {
    {{ mclag.icl_interface }} {
        description "{{ mclag.icl.description }}";
        unit 0 {
            family ethernet-switching {
                interface-mode trunk;
                vlan {
                    members {{ mclag_shared.iccp.vlan_id }};
                }
            }
        }
    }
{% for link in mclag.links.icl.links %}
    {{ link }} {
        ether-options {
            802.3ad {{ mclag.icl_interface }};
        }
    }
{% endfor %}
{# IRB interface used for ICCP communication #}

    irb {
        unit {{ mclag_shared.iccp.vlan_id }} {
            family inet {
                address {{ mclag.iccp.local_ip }}/24
            }
        }
    }
}
vlans {
    {{ mclag_shared.iccp.vlan_name }} {
        vlan-id {{ mclag_shared.iccp.vlan_id }};
        l3-interface irb.{{ mclag_shared.iccp.vlan_id }};
    }
}
{# ICCP Protocol Configuration #}


switch-options {
    service-id 10;
}
{#}
multicast-snooping-options {
    multichassis-lag-replicate-state;
}
#}

multi-chassis {
    multi-chassis-protection {{ mclag.iccp.peer_ip }} {
        interface {{ mclag.icl_interface }};
    }
}
